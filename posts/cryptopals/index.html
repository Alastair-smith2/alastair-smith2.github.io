<!DOCTYPE html><html lang="en" q:container="paused" q:version="1.12.0" q:render="ssr" q:base="/build/" q:locale="" q:manifest-hash="tlg38i" q:instance="p4mo8b418pa"><!--qv q:id=0 q:key=PtIy:ph_0--><!--qv q:id=1 q:key=UUZf:gH_3--><!--qv q:s q:sref=1 q:key=--><head q:head><meta charSet="utf-8" q:head><link rel="manifest" href="/manifest.json" q:head><!--qv q:id=2 q:key=0zdj:gH_0--><!--qv q:key=li_0--><title q:head>Cryptopals</title><link rel="canonical" href="https://alastair-smith2.github.io/posts/cryptopals/" q:id="3" q:head><meta name="viewport" content="width=device-width, initial-scale=1.0" q:head><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" q:head><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" q:head><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" q:head><link rel="manifest" href="/site.webmanifest" q:head><meta name="author" content="Alastair Smith" q:head><meta name="description" content="Some lessons learnt about cryptography from doing the cryptopals challenges" q:head><meta property="og:title" content="Some lessons learnt about cryptography from doing the cryptopals challenges" q:head><meta property="og:description" content="Some lessons learnt about cryptography from doing the cryptopals challenges" q:head><!--/qv--><!--/qv--><style q:style="yuux3y-0" hidden>/*! tailwindcss v3.3.0 | MIT License | https://tailwindcss.com
 */*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-top:1.2em;margin-bottom:1.2em}.prose :where(a):not(:where([class~=not-prose] *)){color:var(--tw-prose-links);text-decoration:underline;font-weight:500}.prose :where(strong):not(:where([class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose] *)){list-style-type:decimal;margin-top:1.25em;margin-bottom:1.25em;padding-left:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose] *)){list-style-type:disc;margin-top:1.25em;margin-bottom:1.25em;padding-left:1.625em}.prose :where(ol>li):not(:where([class~=not-prose] *))::marker{font-weight:400;color:var(--tw-prose-counters)}.prose :where(ul>li):not(:where([class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(hr):not(:where([class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose :where(blockquote):not(:where([class~=not-prose] *)){font-weight:500;font-style:italic;color:var(--tw-prose-quotes);border-left-width:.25rem;border-left-color:var(--tw-prose-quote-borders);quotes:"“""”""‘""’";margin-top:1.6em;margin-bottom:1.6em;padding-left:1em}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose :where(h1 strong):not(:where([class~=not-prose] *)){font-weight:900;color:inherit}.prose :where(h2):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333}.prose :where(h2 strong):not(:where([class~=not-prose] *)){font-weight:800;color:inherit}.prose :where(h3):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6}.prose :where(h3 strong):not(:where([class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(h4):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.5em;margin-bottom:.5em;line-height:1.5}.prose :where(h4 strong):not(:where([class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(img):not(:where([class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(figure>*):not(:where([class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(figcaption):not(:where([class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose :where(code):not(:where([class~=not-prose] *)){color:var(--tw-prose-code);font-weight:600;font-size:.875em}.prose :where(code):not(:where([class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose] *)){color:var(--tw-prose-pre-code);background-color:var(--tw-prose-pre-bg);overflow-x:auto;font-weight:400;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em}.prose :where(pre code):not(:where([class~=not-prose] *)){background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose :where(pre code):not(:where([class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose] *)){width:100%;table-layout:auto;text-align:left;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.7142857}.prose :where(thead):not(:where([class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-th-borders)}.prose :where(thead th):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;vertical-align:bottom;padding-right:.5714286em;padding-bottom:.5714286em;padding-left:.5714286em}.prose :where(tbody tr):not(:where([class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-td-borders)}.prose :where(tbody tr:last-child):not(:where([class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose] *)){border-top-width:1px;border-top-color:var(--tw-prose-th-borders)}.prose :where(tfoot td):not(:where([class~=not-prose] *)){vertical-align:top}.prose{--tw-prose-body: #374151;--tw-prose-headings: #111827;--tw-prose-lead: #4b5563;--tw-prose-links: #111827;--tw-prose-bold: #111827;--tw-prose-counters: #6b7280;--tw-prose-bullets: #d1d5db;--tw-prose-hr: #e5e7eb;--tw-prose-quotes: #111827;--tw-prose-quote-borders: #e5e7eb;--tw-prose-captions: #6b7280;--tw-prose-code: #111827;--tw-prose-pre-code: #e5e7eb;--tw-prose-pre-bg: #1f2937;--tw-prose-th-borders: #d1d5db;--tw-prose-td-borders: #e5e7eb;--tw-prose-invert-body: #d1d5db;--tw-prose-invert-headings: #fff;--tw-prose-invert-lead: #9ca3af;--tw-prose-invert-links: #fff;--tw-prose-invert-bold: #fff;--tw-prose-invert-counters: #9ca3af;--tw-prose-invert-bullets: #4b5563;--tw-prose-invert-hr: #374151;--tw-prose-invert-quotes: #f3f4f6;--tw-prose-invert-quote-borders: #374151;--tw-prose-invert-captions: #9ca3af;--tw-prose-invert-code: #fff;--tw-prose-invert-pre-code: #d1d5db;--tw-prose-invert-pre-bg: rgb(0 0 0 / 50%);--tw-prose-invert-th-borders: #4b5563;--tw-prose-invert-td-borders: #374151;font-size:1rem;line-height:1.75}.prose :where(video):not(:where([class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(figure):not(:where([class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(li):not(:where([class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose] *)){padding-left:.375em}.prose :where(ul>li):not(:where([class~=not-prose] *)){padding-left:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(.prose>ul>li>*:first-child):not(:where([class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>*:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>*:first-child):not(:where([class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>*:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(hr+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose] *)){padding-left:0}.prose :where(thead th:last-child):not(:where([class~=not-prose] *)){padding-right:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose] *)){padding:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose] *)){padding-left:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose] *)){padding-right:0}.prose :where(.prose>:first-child):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose] *)){margin-bottom:0}.static{position:static}.row-span-1{grid-row:span 1 / span 1}.row-span-3{grid-row:span 3 / span 3}.row-end-1{grid-row-end:1}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.block{display:block}.inline{display:inline}.flex{display:flex}.grid{display:grid}.min-h-screen{min-height:100vh}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-none{max-width:none}.basis-1\/4{flex-basis:25%}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.gap-2{gap:.5rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.border{border-width:1px}.border-solid{border-style:solid}.border-gray-700{--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity))}.bg-emerald-700{--tw-bg-opacity: 1;background-color:rgb(4 120 87 / var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity))}.bg-slate-900{--tw-bg-opacity: 1;background-color:rgb(15 23 42 / var(--tw-bg-opacity))}.p-2{padding:.5rem}.p-6{padding:1.5rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-normal{font-weight:400}.font-semibold{font-weight:600}.leading-3{line-height:.75rem}.tracking-tight{letter-spacing:-.025em}.text-emerald-300{--tw-text-opacity: 1;color:rgb(110 231 183 / var(--tw-text-opacity))}.text-emerald-500{--tw-text-opacity: 1;color:rgb(16 185 129 / var(--tw-text-opacity))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.underline{text-decoration-line:underline}.underline-offset-1{text-underline-offset:1px}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.delay-100{transition-delay:.1s}.duration-300{transition-duration:.3s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.hover\:-translate-y-1:hover{--tw-translate-y: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-110:hover{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-emerald-700:hover{--tw-bg-opacity: 1;background-color:rgb(4 120 87 / var(--tw-bg-opacity))}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.hover\:text-emerald-300:hover{--tw-text-opacity: 1;color:rgb(110 231 183 / var(--tw-text-opacity))}.hover\:text-emerald-700:hover{--tw-text-opacity: 1;color:rgb(4 120 87 / var(--tw-text-opacity))}.hover\:underline:hover{text-decoration-line:underline}.prose-h1\:text-white :is(:where(h1):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.prose-h2\:text-3xl :is(:where(h2):not(:where([class~=not-prose] *))){font-size:1.875rem;line-height:2.25rem}.prose-h2\:text-white :is(:where(h2):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.prose-h3\:text-2xl :is(:where(h3):not(:where([class~=not-prose] *))){font-size:1.5rem;line-height:2rem}.prose-h3\:text-white :is(:where(h3):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.prose-p\:text-lg :is(:where(p):not(:where([class~=not-prose] *))){font-size:1.125rem;line-height:1.75rem}.prose-p\:text-white :is(:where(p):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.prose-a\:text-emerald-300 :is(:where(a):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(110 231 183 / var(--tw-text-opacity))}.hover\:prose-a\:text-emerald-700 :is(:where(a):not(:where([class~=not-prose] *))):hover{--tw-text-opacity: 1;color:rgb(4 120 87 / var(--tw-text-opacity))}.prose-strong\:text-emerald-500 :is(:where(strong):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(16 185 129 / var(--tw-text-opacity))}.prose-li\:text-white :is(:where(li):not(:where([class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}@media (min-width: 640px){.sm\:mb-0{margin-bottom:0}.sm\:mb-5{margin-bottom:1.25rem}.sm\:mt-0{margin-top:0}.sm\:flex{display:flex}.sm\:basis-1\/2{flex-basis:50%}.sm\:basis-1\/3{flex-basis:33.333333%}.sm\:flex-row{flex-direction:row}.sm\:items-center{align-items:center}.sm\:justify-center{justify-content:center}.sm\:justify-between{justify-content:space-between}}@media (min-width: 768px){.md\:basis-1\/3{flex-basis:33.333333%}}@media (min-width: 1024px){.lg\:mb-6{margin-bottom:1.5rem}}</style><style q:style="muwzkm-0" hidden>:root{view-transition-name:none}</style></head><body lang="en"><!--qv q:id=4 q:key=lFaj:gH_1--><!--qv q:key=1j_2--><!--qv q:id=5 q:key=uAko:1j_0--><div class="bg-slate-900 min-h-screen grid gap-2 grid-cols-1 grid-rows-3" q:key="S4_3"><!--qv q:id=6 q:key=RROC:S4_0--><header class="flex flex-col sm:flex-row sm:justify-between p-6 sm:mb-5 lg:mb-6 row-end-1" q:key="HD_2"><div class="sm:basis-1/3"><!--qv q:id=7 q:key=k9Rs:HD_0--><a q:link href="/" data-prefetch on:click="#0
q-D9p23QXw.js#s_qC0ke6GVJbg[0 1 1 1]" on:mouseover="q-5vjUj86P.js#s_WG90PQWmBN8" on:focus="q-5vjUj86P.js#s_WG90PQWmBN8" on:qvisible="q-5vjUj86P.js#s_WG90PQWmBN8" q:key="1j_6" q:id="8"><!--qv q:s q:sref=7 q:key=--><h1 class="text-3xl text-emerald-500 hover:text-emerald-300">Alastair Smith</h1><!--/qv--></a><!--/qv--></div><!--qv q:id=9 q:key=900f:HD_1--><ul class="mt-3 sm:mt-0 sm:basis-1/2 md:basis-1/3 flex flex-row sm:justify-between" q:key="il_0"><!--qv q:id=a q:key=9HbN:Home--><li class="sm:flex sm:justify-center basis-1/4 sm:basis-1/3 items-center false" q:key="pj_2"><!--qv q:id=b q:key=k9Rs:pj_1--><a q:link href="/" data-prefetch class="hover:text-emerald-700 text-white p-2
        false 
        false" on:click="#0
q-D9p23QXw.js#s_qC0ke6GVJbg[0 1 1 1]" on:mouseover="q-5vjUj86P.js#s_WG90PQWmBN8" on:focus="q-5vjUj86P.js#s_WG90PQWmBN8" on:qvisible="q-5vjUj86P.js#s_WG90PQWmBN8" q:key="1j_6" q:id="c"><!--qv q:s q:sref=b q:key=--><!--t=d-->Home<!----><!--/qv--></a><!--/qv--></li><!--/qv--><!--qv q:id=e q:key=9HbN:Posts--><li class="sm:flex sm:justify-center basis-1/4 sm:basis-1/3 items-center false" q:key="pj_2"><!--qv q:id=f q:key=k9Rs:pj_1--><a q:link href="/posts/" data-prefetch class="hover:text-emerald-700 text-white p-2
        false 
        false" on:click="#0
q-D9p23QXw.js#s_qC0ke6GVJbg[0 1 1 1]" on:mouseover="q-5vjUj86P.js#s_WG90PQWmBN8" on:focus="q-5vjUj86P.js#s_WG90PQWmBN8" on:qvisible="q-5vjUj86P.js#s_WG90PQWmBN8" q:key="1j_6" q:id="g"><!--qv q:s q:sref=f q:key=--><!--t=h-->Posts<!----><!--/qv--></a><!--/qv--></li><!--/qv--><!--qv q:id=i q:key=9HbN:About--><li class="sm:flex sm:justify-center basis-1/4 sm:basis-1/3 items-center false" q:key="pj_2"><!--qv q:id=j q:key=k9Rs:pj_1--><a q:link href="/about/" data-prefetch class="hover:text-emerald-700 text-white p-2
        false 
        false" on:click="#0
q-D9p23QXw.js#s_qC0ke6GVJbg[0 1 1 1]" on:mouseover="q-5vjUj86P.js#s_WG90PQWmBN8" on:focus="q-5vjUj86P.js#s_WG90PQWmBN8" on:qvisible="q-5vjUj86P.js#s_WG90PQWmBN8" q:key="1j_6" q:id="k"><!--qv q:s q:sref=j q:key=--><!--t=l-->About<!----><!--/qv--></a><!--/qv--></li><!--/qv--></ul><!--/qv--></header><!--/qv--><main class="row-span-3"><section class="max-w-4xl mx-auto p-6"><!--qv q:s q:sref=5 q:key=--><!--qv q:id=m q:key=BIIg:--><article class="prose max-w-none prose-h2:text-3xl prose-h3:text-2xl prose-h1:text-white prose-h2:text-white prose-h3:text-white prose-p:text-lg prose-p:text-white prose-a:text-emerald-300 hover:prose-a:text-emerald-700 prose-li:text-white prose-strong:text-emerald-500" q:key="SR_1"><!--qv q:s q:sref=m q:key=--><h1 id="cryptopals-getting-stuck-into-cryptography"><a aria-hidden="true" tabindex="-1" href="#cryptopals-getting-stuck-into-cryptography"><span class="icon icon-link"></span></a>Cryptopals: Getting stuck into cryptography</h1><ol>
<li><a href="#what-is-cryptopals">What is cryptopals?</a></li>
<li><a href="#trapdoor">What makes a good cryptographic algorithm?</a></li>
<li><a href="#diffie-hellman">Diffie-Hellman</a></li>
<li><a href="#integer-factorisation">Integer factorisation</a></li>
<li><a href="#ecdlp">Elliptic curve discrete logarithm problem</a></li>
<li><a href="#secure-for-now">Why current cryptographic algorithms are secure - for now</a></li>
<li><a href="#insecure-randomness">Insecure randomness</a></li>
<li><a href="#summary">Summary</a></li>
</ol><h2 id="-what-is-cryptopals"><a aria-hidden="true" tabindex="-1" href="#-what-is-cryptopals"><span class="icon icon-link"></span></a><a name="what-is-cryptopals"></a> What is cryptopals?</h2><p>At first glance people could be mistaken for thinking this post is going to be related to cryptocurrency, but that is not the case. <!--qv q:id=n q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://cryptopals.com/" q:key="SR_2" q:id="o"><!--t=p-->Cryptopals<!----></a><!--/qv--> is a series of challenges that relate to cryptography. Cryptography is essential to the modern internet; it helps provide security by preventing others from intercepting communication that is intended to be private, and is fundamental to efforts like <!--qv q:id=q q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://blog.google/technology/safety-security/the-beginning-of-the-end-of-the-password/" q:key="SR_2" q:id="r"><!--t=s-->ending the need for passwords.<!----></a><!--/qv--> The challenges on cryptopals help you learn about cryptography by providing problems that demonstrate how real-world attacks work against various algorithms. This post is some of my learnings from the cryptopals challenges and wider reading.</p><h2 id="-what-makes-a-suitable-cryptographic-algorithm-the-trapdoor-effect"><a aria-hidden="true" tabindex="-1" href="#-what-makes-a-suitable-cryptographic-algorithm-the-trapdoor-effect"><span class="icon icon-link"></span></a><a name="trapdoor"></a> What makes a suitable cryptographic algorithm? The &quot;trapdoor&quot; effect.</h2><p>Cryptography heavily relies upon various &quot;hard&quot; maths problems. These problems which, unless you have some secret information, can take a computer a very very long time (<!--qv q:id=t q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://www.quintessencelabs.com/blog/breaking-rsa-encryption-update-state-art" q:key="SR_2" q:id="u"><!--t=v-->in some cases trillions of years<!----></a><!--/qv-->) to solve. These are <!--qv q:id=w q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Trapdoor_function" q:key="SR_2" q:id="x"><!--t=y-->trapdoor functions<!----></a><!--/qv--> - they make it easy to produce a result in one direction but incredibly difficult to produce the inverse without some secret information. Let’s look at an algorithm and how it leverages this.</p><h2 id="-diffie-hellman"><a aria-hidden="true" tabindex="-1" href="#-diffie-hellman"><span class="icon icon-link"></span></a><a name="diffie-hellman"></a> Diffie-Hellman</h2><p><!--qv q:id=z q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange#" q:key="SR_2" q:id="10"><!--t=11-->Diffie-Hellman<!----></a><!--/qv--> (DH) as an algorithm which paved the way for exchanging <!--qv q:id=12 q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Key_(cryptography)" q:key="SR_2" q:id="13"><!--t=14-->cryptographic keys<!----></a><!--/qv--> securely between parties who may never have had contact before, by establishing
a joint secret. <!--qv q:id=15 q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange" q:key="SR_2" q:id="16"><!--t=17-->Wikipedia<!----></a><!--/qv-->
has an excellent analogy:</p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Diffie-Hellman_Key_Exchange.svg/250px-Diffie-Hellman_Key_Exchange.svg.png" style="background-color: white; margin: 2rem auto;"> <p>The trapdoor effect here can be seen because even though the common paint and initial mixture are available for all to see, the mixture process is incredibly hard to reverse. This means the secret colour can&#39;t be derived from the public information alone. The clever part in DH is that both parties can mix their secret colour with the other’s initial mixture to come up with the same secret.</p><p>In reality very large numbers are used instead of paint.</p><p>Let&#39;s look at an example equation which I have filled with simple numbers:</p><p>2<sup>x</sup>(mod 7) = 2</p><p>The difficulty here is trying to find X (the exponent). In plain English, this equation is asking, what is the number that when 2 is raised to X and then divided by 7, has the remainder 2? This is simple to find for small numbers, but with large numbers it becomes very hard for computers to fathom. This is the <!--qv q:id=18 q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://www.khanacademy.org/computing/computer-science/cryptography/modern-crypt/v/discrete-logarithm-problem" q:key="SR_2" q:id="19"><!--t=1a-->discrete logarithm problem<!----></a><!--/qv-->. In the DH example above the common numbers (e.g. 2 and 7) are agreed by Alice and Bob in advance. Each individual then performs the aforementioned equation with a chosen secret as the exponent. Next, each individual shares the resulting value and then performs the operation again but this time using the resulting value from the other as the number to be raised by their secret. In the end they both end up with the same number that can be used as a secret for secure communication! I enjoyed learning the maths behind this one. It was also interesting learning how to use this maths concretely in a programming language - I had been using Rust for the challenges and there&#39;s a convenient package that has the <!--qv q:id=1b q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://docs.rs/num-bigint/latest/num_bigint/struct.BigUint.html#method.modpow" q:key="SR_2" q:id="1c"><!--t=1d-->modpow operation<!----></a><!--/qv-->.</p><p>Let&#39;s delve a bit deeper into some other maths that is leveraged to create the &quot;trapdoor&quot; effect in modern algorithms.</p><h2 id="-integer-factorisation"><a aria-hidden="true" tabindex="-1" href="#-integer-factorisation"><span class="icon icon-link"></span></a><a name="integer-factorisation"></a> Integer factorisation</h2><p>Given the number 713, can you tell me what its prime factors are without using a computer? By trial and error eventually you’d calculate that they were 23 and 31. But what if I gave you the number 843151 and said I was looking for the two specific prime factors that multiply together to make that number? By hand you’d likely not bother but maybe you’d google it. On the other hand, what if I had asked for the result of multiplying 863 and 977 together? That is easy: the number is 843151. This maths - integer factorisation using primes only - is at the heart of the popular <!--qv q:id=1e q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" q:key="SR_2" q:id="1f"><!--t=1g-->RSA algorithm<!----></a><!--/qv--> that is widely used for secure communication. Part of the RSA algorithm is generating a number (N, which is used as a modulus in the algorithm and shared publicly) from two very large prime numbers. In real life the prime numbers are hundreds of digits long. If the prime numbers could easily be derived from N, the RSA algorithm would be rendered insecure because the private key - which is used to decrypt messages that are encrypted with the public key - could be derived. For current RSA-2048 bit encryption keys it would take a <!--qv q:id=1h q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://www.quintessencelabs.com/blog/breaking-rsa-encryption-update-state-art" q:key="SR_2" q:id="1i"><!--t=1j-->computer ~300 trillion years<!----></a><!--/qv--> to find the prime numbers. There are ways to attack RSA if the prime numbers are too small or too close together.</p><h2 id="-simplified-overview-of-the-elliptic-curve-discrete-logarithm-problem"><a aria-hidden="true" tabindex="-1" href="#-simplified-overview-of-the-elliptic-curve-discrete-logarithm-problem"><span class="icon icon-link"></span></a><a name="ecdlp"></a> Simplified overview of the Elliptic Curve Discrete Logarithm Problem</h2><p>This section we’ll be looking at some maths involved in Elliptic Curve Cryptography (ECC). Hopefully upon completing this section you’ll feel like you understand a simplified explanation of the &quot;hard&quot; maths problem at the core of ECC. An elliptic curve satisfies the equation y<sup>2</sup> = x<sup>3</sup> + ax + b and is symmetrical across the x-axis. For our purposes, the top right curve on the diagram below is the most helpful image.</p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/EllipticCurveCatalog.svg/800px-EllipticCurveCatalog.svg.png" style="background-color: white; margin: 2rem auto;"><p>An interesting problem they present is represented in the form of an equation nP = E, where the value n here is the number
of times point P was &quot;dotted&quot; on a curve. Before explaining what &quot;dotted&quot; means, a
key piece of information is this: for two given points on a curve (e.g. our starting
points A and B, which will both be on one side of the x-axis) there will always be at most a third point. What this means is for our
starting point we can find the third point - C - on the curve, by drawing a straight
line through A and B. Once we’ve found where this line intercepts on the curve, we
find the corresponding point of the curve on the other side of the x-axis and this
becomes C. Now we repeat the process using A and C as our two points to find where
the next part of the graph is intercepted and flip over the x-axis again to find D. If you’d like
to see a visual representation of this process <!--qv q:id=1k q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=gAtBM06xwaw" q:key="SR_2" q:id="1l"><!--t=1m-->this video<!----></a><!--/qv--> is an excellent resource. This process,
which is the adding of a point to itself, is often referred to &quot;dotting&quot;. Formally, this is called <!--qv q:id=1n q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication" q:key="SR_2" q:id="1o"><!--t=1p-->Elliptic curve point multiplication<!----></a><!--/qv-->
and the number of times we &quot;dot&quot; becomes our private key (n). E is the result of
how many times we &quot;dotted&quot; the starting point P. Finding n from E and P is incredibly
difficult but finding E from n and P is simple for computers. This problem is known
as the Elliptic Curve Discrete Logarithm Problem (ECDLP) and is a form of the discrete
logarithm problem we saw earlier.</p><p>An interesting point about elliptic curves in comparison to algorithms like RSA is for numbers of
the same size they essentially give us more &quot;bang for our buck&quot; in terms of security.
According to this <!--qv q:id=1q q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://eprint.iacr.org/2013/635.pdf" q:key="SR_2" q:id="1r"><!--t=1s-->paper<!----></a><!--/qv--> (which has the analogy of how much water you’d need to bring to a boil for the idea
of difficulty or &quot;security&quot;) it only takes a 210-bit elliptic curve key to match
a 1990-bit RSA key, hence why algorithms like <!--qv q:id=1t q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" q:key="SR_2" q:id="1u"><!--t=1v-->ECDSA<!----></a><!--/qv-->
are popular.</p><h2 id="-why-current-cryptographic-solutions-widely-used-today-are-secure---for-now"><a aria-hidden="true" tabindex="-1" href="#-why-current-cryptographic-solutions-widely-used-today-are-secure---for-now"><span class="icon icon-link"></span></a><a name="secure-for-now"></a> Why current cryptographic solutions widely used today are secure - for now.</h2><p>While these algorithms are popular today, they are almost certainly going to be replaced in the future due to <!--qv q:id=1w q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://blog.cloudflare.com/towards-post-quantum-cryptography-in-tls/" q:key="SR_2" q:id="1x"><!--t=1y-->quantum computers<!----></a><!--/qv-->. A quantum computer could execute algorithms (<!--qv q:id=1z q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://quantum-computing.ibm.com/composer/docs/iqx/guide/shors-algorithm" q:key="SR_2" q:id="20"><!--t=21-->Shor’s algorithm<!----></a><!--/qv--> is the most relevant to this post) which would be able to solve the &quot;hard&quot; problems discussed here in a matter of seconds or minutes. Quantum computers will essentially render current cryptographic algorithms useless, so nothing would be secure. Thankfully there has been a lot of work already done to solve this problem with the development of post-quantum algorithms. <!--qv q:id=22 q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://blog.cloudflare.com/nist-post-quantum-surprise/" q:key="SR_2" q:id="23"><!--t=24-->This blog post<!----></a><!--/qv--> gives a detailed walkthrough of various algorithms with their various trade-offs, and outlines which ones are being standardised, for those who are interested.</p><h2 id="-a-very-easy-way-to-shoot-yourself-in-the-foot-in-cryptography---insecure-randomness"><a aria-hidden="true" tabindex="-1" href="#-a-very-easy-way-to-shoot-yourself-in-the-foot-in-cryptography---insecure-randomness"><span class="icon icon-link"></span></a><a name="insecure-randomness"></a> A very easy way to shoot yourself in the foot in cryptography - insecure randomness</h2><p>Cryptography needs a degree of randomness. One example is that if the same word, e.g. &quot;hello&quot;, always produced the same ciphertext (the output of the message into an encryption function) then it would be very easy to decipher messages over time. This is because an attacker could build a dictionary of how plaintext relates to ciphertext. Pseudo-Random Number Generators (PRNGs) are often used to approximate randomness in programs but are highly predictable because the sequence of numbers they produce is based off a seed. The trouble comes in when PRNGs are used for cryptographic purposes because suddenly what should be seemingly random, isn’t. For example, <!--qv q:id=25 q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://owasp.org/www-community/vulnerabilities/Insecure_Randomness" q:key="SR_2" q:id="26"><!--t=27-->OWASP<!----></a><!--/qv--> give a great example where a receipt URL is generated using a PRNG for part of the URL with the current time as the seed:</p><div data-rehype-pretty-code-fragment=""><pre style="background-color:#1E1E1E" tabindex="0" data-language="java" data-theme="default"><code data-language="java" data-theme="default" style="display:grid"><span data-line=""><span style="color:#4EC9B0">String</span><span style="color:#D4D4D4"> </span><span style="color:#DCDCAA">generateReceiptURL</span><span style="color:#D4D4D4">(</span><span style="color:#4EC9B0">String</span><span style="color:#D4D4D4"> baseUrl) {</span></span>
<span data-line=""><span style="color:#D4D4D4">  </span><span style="color:#4EC9B0">Random</span><span style="color:#D4D4D4"> </span><span style="color:#9CDCFE">ranGen</span><span style="color:#D4D4D4"> = </span><span style="color:#C586C0">new</span><span style="color:#D4D4D4"> </span><span style="color:#DCDCAA">Random</span><span style="color:#D4D4D4">();</span></span>
<span data-line=""><span style="color:#D4D4D4">  </span><span style="color:#9CDCFE">ranGen</span><span style="color:#D4D4D4">.</span><span style="color:#DCDCAA">setSeed</span><span style="color:#D4D4D4">((</span><span style="color:#C586C0">new</span><span style="color:#D4D4D4"> </span><span style="color:#DCDCAA">Date</span><span style="color:#D4D4D4">()).</span><span style="color:#DCDCAA">getTime</span><span style="color:#D4D4D4">());</span></span>
<span data-line=""><span style="color:#D4D4D4">  </span><span style="color:#C586C0">return</span><span style="color:#D4D4D4">(baseUrl + </span><span style="color:#9CDCFE">Gen</span><span style="color:#D4D4D4">.</span><span style="color:#DCDCAA">nextInt</span><span style="color:#D4D4D4">(</span><span style="color:#B5CEA8">400000000</span><span style="color:#D4D4D4">) + </span><span style="color:#CE9178">&quot;.html&quot;</span><span style="color:#D4D4D4">);</span></span>
<span data-line=""><span style="color:#D4D4D4">}</span></span></code></pre></div><p>The problem here is that if an attacker determined that a specific time was the seed for the URL then it’s possible for them a) identify other receipt URLs by brute forcing time ranges and b) predict future valid URLs based on a given time. Instead, Cryptographic Pseudo-Random Number Generators (CPRNGs) are designed for these scenarios because they are not predictable in the same manner - these should be used rather than PRNGs.</p><p>There are algorithms that depend upon an initialisation vector (IV) for randomness to ensure repeated words do not produce repeated cipher text as described earlier. Using an inappropriate PRNG that repeats values with these algorithms in some circumstances <!--qv q:id=28 q:key=mugB:--><a target="_blank" rel="noopener noreferrer" href="https://stackered.com/blog/iv-mishandling/" q:key="SR_2" q:id="29"><!--t=2a-->can actually lead to attackers being able to determine the plaintext of a ciphertext<!----></a><!--/qv--> without the encryption key. From a security perspective this would be disastrous.</p><h2 id="-summary"><a aria-hidden="true" tabindex="-1" href="#-summary"><span class="icon icon-link"></span></a><a name="summary"></a> Summary</h2><p>I really enjoyed (and at times found very frustrating) some of the cryptopals challenges. I&#39;ve learned a lot about cryptography which I didn&#39;t know before, such as the inner workings of various algorithms and some of the &quot;hard&quot; maths problems involved. There are many elements (e.g. the inner workings of elliptic curves) that I would not dare claim to be an expert about but I have a lot more working knowledge and points of reference than I did when I started cryptopals.</p><p>I ran into a situation recently where upgrading a dependency highlighted the use of an algorithm that is no longer fit for purpose. Having looked up the algorithm, it was very rewarding to see that some of the knowledge I had picked up through the cryptopals challenges was directly relevant. I ended up having a good discussion with some of my colleagues off the back of it.</p><!--/qv--></article><!--/qv--><!--/qv--></section></main><!--qv q:id=2b q:key=pvSf:S4_2--><footer class="p-6 flex flex-col sm:flex-row sm:justify-between row-span-1" q:key="0C_1"><p class="sm:basis-1/3 sm:flex sm:items-center text-emerald-500 mb-6 sm:mb-0">©2022 <!--t=2c-->- 2025<!----></p><!--qv q:id=2d q:key=900f:0C_0--><ul class="mt-3 sm:mt-0 sm:basis-1/2 md:basis-1/3 flex flex-row sm:justify-between" q:key="il_0"><!--qv q:id=2e q:key=9HbN:Twitter--><li class="sm:flex sm:justify-center basis-1/4 sm:basis-1/3 items-center transition ease-in-out delay-100 hover:-translate-y-1 hover:scale-110 duration-300" q:key="pj_2"><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/alastair_smith2" class="hover:text-emerald-700 text-white p-2
        false 
        rounded-full bg-emerald-700 hover:bg-white" q:key="pj_0" q:id="2f"><!--t=2g-->Twitter<!----></a></li><!--/qv--><!--qv q:id=2h q:key=9HbN:Github--><li class="sm:flex sm:justify-center basis-1/4 sm:basis-1/3 items-center transition ease-in-out delay-100 hover:-translate-y-1 hover:scale-110 duration-300" q:key="pj_2"><a target="_blank" rel="noopener noreferrer" href="https://github.com/Alastair-smith2" class="hover:text-emerald-700 text-white p-2
        false 
        rounded-full bg-emerald-700 hover:bg-white" q:key="pj_0" q:id="2i"><!--t=2j-->Github<!----></a></li><!--/qv--><!--qv q:id=2k q:key=9HbN:LinkedIn--><li class="sm:flex sm:justify-center basis-1/4 sm:basis-1/3 items-center transition ease-in-out delay-100 hover:-translate-y-1 hover:scale-110 duration-300" q:key="pj_2"><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/alastair-smith-8b1819134" class="hover:text-emerald-700 text-white p-2
        false 
        rounded-full bg-emerald-700 hover:bg-white" q:key="pj_0" q:id="2l"><!--t=2m-->LinkedIn<!----></a></li><!--/qv--></ul><!--/qv--></footer><!--/qv--></div><!--/qv--><script on-document:qcinit="q-C6d4FJHC.js#s_GOLd19yEFuY" on-document:qinit="#1" q:key="1j_1"></script><!--/qv--><!--/qv--><!--qv q:key=gH_2--><script q:key="1j_7">((i,r,a,o)=>{a=e=>{const t=document.querySelector("[q\\:base]");t&&r.active&&r.active.postMessage({type:"qprefetch",base:t.getAttribute("q:base"),...e})},document.addEventListener("qprefetch",e=>{const t=e.detail;r?a(t):i.push(t)}),"serviceWorker"in navigator?navigator.serviceWorker.register("/service-worker.js").then(e=>{o=()=>{r=e,i.forEach(a),a({bundles:i})},e.installing?e.installing.addEventListener("statechange",t=>{t.target.state=="activated"&&o()}):e.active&&o()}).catch(e=>console.error(e)):console.log("Service worker not supported in this browser.")})([])</script><!--/qv--></body><!--/qv--><!--/qv--><!--/qv--><link rel="modulepreload" href="/build/q-Bay4bHT8.js"><script q:type="prefetch-bundles">(window.qwikPrefetchSW||(window.qwikPrefetchSW=[])).push(["prefetch","/build/","q-CCIQAFi1.js","q-Bay4bHT8.js","q-CDwkEk2S.js","q-Du-Qr_qX.js","q-D9p23QXw.js","q-CC-m-CgY.js","q-5vjUj86P.js","q-C6d4FJHC.js","q-C4aygQZv.js","q-BggzM5c6.js"]);document.dispatchEvent(new CustomEvent('qprefetch', {detail:{links: [location.pathname]}}))</script><script type="qwik/json">{"refs":{"8":"39 6p","c":"39 6p","g":"39 6p","k":"39 6p"},"ctx":{"0":{"c":"show-draft-posts=34"},"1":{"h":" 36!","w":"38","c":"qc-c=i! qc-ic=v qc-h=s! qc-l=t! qc-n=39 qc-s=30! qc-a=w qc-ir=u qc-p=33"},"2":{"h":"3a","s":"s! t!"},"4":{"h":"2n","s":"v"},"9":{"h":" 3l!"},"12":{"h":" 1b!"},"15":{"h":" 1c!"},"18":{"h":" 1d!"},"22":{"h":" 1n!"},"25":{"h":" 1o!"},"28":{"h":" 1p!"},"a":{"h":"3o x!","s":"t!"},"b":{"h":"4g 13!","s":"39 t!"},"e":{"h":"3o y!","s":"t!"},"f":{"h":"4g 14!","s":"39 t!"},"i":{"h":"3o z!","s":"t!"},"j":{"h":"4g 15!","s":"39 t!"},"n":{"h":" 16!"},"q":{"h":" 17!"},"t":{"h":" 18!"},"w":{"h":" 19!"},"z":{"h":" 1a!"},"1b":{"h":" 1e!"},"1e":{"h":" 1f!"},"1h":{"h":" 1g!"},"1k":{"h":" 1h!"},"1n":{"h":" 1i!"},"1q":{"h":" 1j!"},"1t":{"h":" 1k!"},"1w":{"h":" 1l!"},"1z":{"h":" 1m!"},"2d":{"h":" 44!"},"2e":{"h":"3o 10!","s":"t!"},"2h":{"h":"3o 11!","s":"t!"},"2k":{"h":"3o 12!","s":"t!"}},"objs":[{"text":"1q","id":"1r","level":"1s"},{"text":"1t","id":"1u","level":"1v"},{"text":"1w","id":"1x","level":"1v"},{"text":"1y","id":"1z","level":"1v"},{"text":"20","id":"21","level":"1v"},{"text":"22","id":"23","level":"1v"},{"text":"24","id":"25","level":"1v"},{"text":"26","id":"27","level":"1v"},{"text":"28","id":"29","level":"1v"},["0","1","2","3","4","5","6","7","8"],{"text":"2b","href":"2c"},{"text":"2d","href":"2e"},{"text":"2f","href":"2g"},{"text":"2h","href":"2i"},{"text":"2j","href":"2k"},{"text":"2l","href":"2m"},["a","b","c","d","e","f"],{"text":"2a","items":"g"},{"headings":"9","menu":"h"},{"name":"2p","content":"2q"},{"name":"2r","content":"2s"},{"property":"2t","content":"2s"},{"property":"2u","content":"2s"},["j","k","l","m"],[],[],[],{"Date":"2v"},{"title":"2o","meta":"n","links":"o","styles":"p","scripts":"q","frontmatter":"r"},{"url":"2x","params":"2y","isNavigating":"2z","prevUrl":"6p"},"\u001232","\u00126p","\u00126p",{"$$style":"3m","item":"3d"},{"$$style":"3p","item":"3g"},{"$$style":"3r","item":"3j"},{"$$style":"45","item":"3w"},{"$$style":"48","item":"3z"},{"$$style":"4b","item":"42"},{"class":"4e","$$href":"4f"},{"class":"4e","$$href":"4h"},{"class":"4e","$$href":"4i"},{"text":"2o","href":"4j"},{"text":"4m","href":"4n"},{"text":"4q","href":"4r"},{"text":"4u","href":"4v"},{"text":"4y","href":"4z"},{"href":"52","text":"53"},{"text":"56","href":"57"},{"text":"5a","href":"5b"},{"text":"5e","href":"5f"},{"text":"5i","href":"5j"},{"text":"5m","href":"4r"},{"text":"5p","href":"5q"},{"text":"5t","href":"5u"},{"text":"5x","href":"5y"},{"text":"61","href":"62"},{"text":"65","href":"66"},{"text":"69","href":"6a"},{"text":"6d","href":"6e"},{"text":"6h","href":"6i"},{"text":"6l","href":"6m"},"Cryptopals: Getting stuck into cryptography","cryptopals-getting-stuck-into-cryptography",1," What is cryptopals?","-what-is-cryptopals",2," What makes a suitable cryptographic algorithm? The \"trapdoor\" effect.","-what-makes-a-suitable-cryptographic-algorithm-the-trapdoor-effect"," Diffie-Hellman","-diffie-hellman"," Integer factorisation","-integer-factorisation"," Simplified overview of the Elliptic Curve Discrete Logarithm Problem","-simplified-overview-of-the-elliptic-curve-discrete-logarithm-problem"," Why current cryptographic solutions widely used today are secure - for now.","-why-current-cryptographic-solutions-widely-used-today-are-secure---for-now"," A very easy way to shoot yourself in the foot in cryptography - insecure randomness","-a-very-easy-way-to-shoot-yourself-in-the-foot-in-cryptography---insecure-randomness"," Summary","-summary","Recent blogs posts","Technical writing: Learnings from Google's technical writing course: January 2025: Writing","/posts/technical-writing/","Learning about data engineering: Reflecting on what stood out as a software engineer: December 2024: Data Engineering","/posts/data-engineering/","Thinking about pressure: A curse or a blessing in disguise?: August 2024: Reflections","/posts/thinking-about-pressure/","Major version upgrades: Dreaming of what could be normal: November 2023: Feature Flags, React Native","/posts/major-version-upgrades/","Cryptopals: Getting stuck into cryptography: May 2023: Cryptography","/posts/cryptopals/","New blog: Why and what it's built with: March 2023: Blog, Technology","/posts/new-blog/","\u0002q-hdbq_Pbs.js#s_lFajsNVuBt8","Cryptopals","author","Alastair Smith","description","Some lessons learnt about cryptography from doing the cryptopals challenges","og:title","og:description","10/05/2023","\u0011t! @2","\u0005https://alastair-smith2.github.io/posts/cryptopals/",{},false,{},"initial",{"type":"31","dest":"2x"},"\u0002q-Ba0olUOc.js#s_EDQA0gIUuGk",{"showDraftPosts":"2z"},{},{},"\u0002q-CCIQAFi1.js#s_Mbo8jIiyeio[w i! v s! 6p 39 30! 35 36! u t!]","\u00032 h 37 #1","\u0002q-CDwkEk2S.js#s_8AIsQxMk4QE[w 35 u t!]","\u0002q-C4aygQZv.js#s_0zdjSlyYHGs","/","Home",{"href":"3b","text":"3c"},"/posts/","Posts",{"href":"3e","text":"3f"},"/about/","About",{"href":"3h","text":"3i"},["3d","3g","3j"],{"items":"3k"},"\u00113l! @3","\u0011x! @4","\u0002q-BggzM5c6.js#s_9HbNuki98sM","\u00113l! @3","\u0011y! @4","\u00113l! @3","\u0011z! @4","button","https://twitter.com/alastair_smith2","Twitter",{"href":"3u","text":"3v"},"https://github.com/Alastair-smith2","Github",{"href":"3x","text":"3y"},"https://www.linkedin.com/in/alastair-smith-8b1819134","LinkedIn",{"href":"40","text":"41"},["3w","3z","42"],{"style":"3t","items":"43"},"\u001144! @3","\u001110! @5","\u001110! @4","\u001144! @3","\u001111! @5","\u001111! @4","\u001144! @3","\u001112! @5","\u001112! @4","hover:text-emerald-700 text-white p-2\n        false \n        false ","\u0011x! @5","\u0002q-CC-m-CgY.js#s_k9RsdSjpDnU","\u0011y! @5","\u0011z! @5","https://cryptopals.com/","\u001116! @6","\u001116! @7","ending the need for passwords.","https://blog.google/technology/safety-security/the-beginning-of-the-end-of-the-password/","\u001117! @6","\u001117! @7","in some cases trillions of years","https://www.quintessencelabs.com/blog/breaking-rsa-encryption-update-state-art","\u001118! @6","\u001118! @7","trapdoor functions","https://en.wikipedia.org/wiki/Trapdoor_function","\u001119! @6","\u001119! @7","Diffie-Hellman","https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange#","\u00111a! @6","\u00111a! @7","https://en.wikipedia.org/wiki/Key_(cryptography)","cryptographic keys","\u00111b! @6","\u00111b! @7","Wikipedia","https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange","\u00111c! @6","\u00111c! @7","discrete logarithm problem","https://www.khanacademy.org/computing/computer-science/cryptography/modern-crypt/v/discrete-logarithm-problem","\u00111d! @6","\u00111d! @7","modpow operation","https://docs.rs/num-bigint/latest/num_bigint/struct.BigUint.html#method.modpow","\u00111e! @6","\u00111e! @7","RSA algorithm","https://en.wikipedia.org/wiki/RSA_(cryptosystem)","\u00111f! @6","\u00111f! @7","computer ~300 trillion years","\u00111g! @6","\u00111g! @7","this video","https://www.youtube.com/watch?v=gAtBM06xwaw","\u00111h! @6","\u00111h! @7","Elliptic curve point multiplication","https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication","\u00111i! @6","\u00111i! @7","paper","https://eprint.iacr.org/2013/635.pdf","\u00111j! @6","\u00111j! @7","ECDSA","https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm","\u00111k! @6","\u00111k! @7","quantum computers","https://blog.cloudflare.com/towards-post-quantum-cryptography-in-tls/","\u00111l! @6","\u00111l! @7","Shor’s algorithm","https://quantum-computing.ibm.com/composer/docs/iqx/guide/shors-algorithm","\u00111m! @6","\u00111m! @7","This blog post","https://blog.cloudflare.com/nist-post-quantum-surprise/","\u00111n! @6","\u00111n! @7","OWASP","https://owasp.org/www-community/vulnerabilities/Insecure_Randomness","\u00111o! @6","\u00111o! @7","can actually lead to attackers being able to determine the plaintext of a ciphertext","https://stackered.com/blog/iv-mishandling/","\u00111p! @6","\u00111p! @7","\u0001"],"subs":[["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1"],["_1","0 #2","0 #2 name","0 #2 content","0 #2 key"],["_1","0 #2","0 #2 name","0 #2 content","0 #2 key"],["_1","0 #2","0 #2 property","0 #2 content","0 #2 key"],["_1","0 #2","0 #2 property","0 #2 content","0 #2 key"],["_1","0 #2"],["_1","0 #2"],["_1","0 #2"],["_1"],["_1"],["_1","0 #2 title","0 #2 meta","0 #2 links","0 #2 styles"],["1 #3 2w #2 href url","0 #a url","0 #e url","0 #i url","0 #2e url","0 #2h url","0 #2k url"],["0 38"],["0 #4"],["0 38"],["0 #a item","0 #b item","3 #d 3n #d item"],["0 #e item","0 #f item","3 #h 3q #h item"],["0 #i item","0 #j item","3 #l 3s #l item"],["0 #2e item","1 #2f 46 #2e href item","3 #2g 47 #2g item"],["0 #2h item","1 #2i 49 #2h href item","3 #2j 4a #2j item"],["0 #2k item","1 #2l 4c #2k href item","3 #2m 4d #2m item"],["0 #b class"],["0 #f class"],["0 #j class"],["1 #o 4k #n href href","3 #p 4l #p text","3 #p 4l #p text"],["1 #r 4o #q href href","3 #s 4p #s text","3 #s 4p #s text"],["1 #u 4s #t href href","3 #v 4t #v text","3 #v 4t #v text"],["1 #x 4w #w href href","3 #y 4x #y text","3 #y 4x #y text"],["1 #10 50 #z href href","3 #11 51 #11 text","3 #11 51 #11 text"],["1 #13 54 #12 href href","3 #14 55 #14 text","3 #14 55 #14 text"],["1 #16 58 #15 href href","3 #17 59 #17 text","3 #17 59 #17 text"],["1 #19 5c #18 href href","3 #1a 5d #1a text","3 #1a 5d #1a text"],["1 #1c 5g #1b href href","3 #1d 5h #1d text","3 #1d 5h #1d text"],["1 #1f 5k #1e href href","3 #1g 5l #1g text","3 #1g 5l #1g text"],["1 #1i 5n #1h href href","3 #1j 5o #1j text","3 #1j 5o #1j text"],["1 #1l 5r #1k href href","3 #1m 5s #1m text","3 #1m 5s #1m text"],["1 #1o 5v #1n href href","3 #1p 5w #1p text","3 #1p 5w #1p text"],["1 #1r 5z #1q href href","3 #1s 60 #1s text","3 #1s 60 #1s text"],["1 #1u 63 #1t href href","3 #1v 64 #1v text","3 #1v 64 #1v text"],["1 #1x 67 #1w href href","3 #1y 68 #1y text","3 #1y 68 #1y text"],["1 #20 6b #1z href href","3 #21 6c #21 text","3 #21 6c #21 text"],["1 #23 6f #22 href href","3 #24 6g #24 text","3 #24 6g #24 text"],["1 #26 6j #25 href href","3 #27 6k #27 text","3 #27 6k #27 text"],["1 #29 6n #28 href href","3 #2a 6o #2a text","3 #2a 6o #2a text"]]}</script><script q:func="qwik/json">document["qFuncs_p4mo8b418pa"]=[(event,target)=>{if(!(event.metaKey||event.ctrlKey||event.shiftKey||event.altKey)){event.preventDefault();}},
()=>{((w,h)=>{if(!w._qcs&&h.scrollRestoration==="manual"){w._qcs=true;const s=h.state?._qCityScroll;if(s){w.scrollTo(s.x,s.y);}document.dispatchEvent(new Event("qcinit"));}})(window,history);},
(p0,)=>(p0.url.href),
(p0,)=>(p0.style??"link"),
(p0,)=>(p0.item.text),
(p0,)=>(p0.item.href),
(p0,)=>(p0.href),
(p0,)=>(p0.text?p0.text:p0.href)]</script><script id="qwikloader">(()=>{var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,s=(e,s)=>{for(var a in s||(s={}))o.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))r.call(s,a)&&n(e,a,s[a]);return e};((e,t)=>{const o="__q_context__",r=window,n=new Set,a=new Set([e]),i="replace",c="forEach",l="target",f="getAttribute",p="isConnected",b="qvisible",u="_qwikjson_",y=(e,t)=>Array.from(e.querySelectorAll(t)),h=e=>{const t=[];return a.forEach((o=>t.push(...y(o,e)))),t},d=e=>{S(e),y(e,"[q\\:shadowroot]").forEach((e=>{const t=e.shadowRoot;t&&d(t)}))},m=e=>e&&"function"==typeof e.then,w=(e,t,o=t.type)=>{h("[on"+e+"\\:"+o+"]")[c]((r=>g(r,e,t,o)))},q=t=>{if(void 0===t[u]){let o=(t===e.documentElement?e.body:t).lastElementChild;for(;o;){if("SCRIPT"===o.tagName&&"qwik/json"===o[f]("type")){t[u]=JSON.parse(o.textContent[i](/\\x3C(\/?script)/gi,"<$1"));break}o=o.previousElementSibling}}},v=(e,t)=>new CustomEvent(e,{detail:t}),g=async(t,r,n,a=n.type)=>{const c="on"+r+":"+a;t.hasAttribute("preventdefault:"+a)&&n.preventDefault(),t.hasAttribute("stoppropagation:"+a)&&n.stopPropagation();const l=t._qc_,b=l&&l.li.filter((e=>e[0]===c));if(b&&b.length>0){for(const e of b){const o=e[1].getFn([t,n],(()=>t[p]))(n,t),r=n.cancelBubble;m(o)&&await o,r&&n.stopPropagation()}return}const u=t[f](c);if(u){const r=t.closest("[q\\:container]"),a=r[f]("q:base"),c=r[f]("q:version")||"unknown",l=r[f]("q:manifest-hash")||"dev",b=new URL(a,e.baseURI);for(const f of u.split("\n")){const u=new URL(f,b),y=u.href,h=u.hash[i](/^#?([^?[|]*).*$/,"$1")||"default",d=performance.now();let w,v,g;const A=f.startsWith("#"),_={qBase:a,qManifest:l,qVersion:c,href:y,symbol:h,element:t,reqTime:d};if(A){const t=r.getAttribute("q:instance");w=(e["qFuncs_"+t]||[])[Number.parseInt(h)],w||(v="sync",g=Error("sync handler error for symbol: "+h))}else{const e=u.href.split("#")[0];try{const t=import(e);q(r),w=(await t)[h],w||(v="no-symbol",g=Error(`${h} not in ${e}`))}catch(e){v||(v="async"),g=e}}if(!w){E("qerror",s({importError:v,error:g},_)),console.error(g);break}const k=e[o];if(t[p])try{e[o]=[t,n,u],A||E("qsymbol",s({},_));const r=w(n,t);m(r)&&await r}catch(e){E("qerror",s({error:e},_))}finally{e[o]=k}}}},E=(t,o)=>{e.dispatchEvent(v(t,o))},A=e=>e[i](/([A-Z])/g,(e=>"-"+e.toLowerCase())),_=async e=>{let t=A(e.type),o=e[l];for(w("-document",e,t);o&&o[f];){const r=g(o,"",e,t);let n=e.cancelBubble;m(r)&&await r,n=n||e.cancelBubble||o.hasAttribute("stoppropagation:"+e.type),o=e.bubbles&&!0!==n?o.parentElement:null}},k=e=>{w("-window",e,A(e.type))},C=()=>{var o;const s=e.readyState;if(!t&&("interactive"==s||"complete"==s)&&(a.forEach(d),t=1,E("qinit"),(null!=(o=r.requestIdleCallback)?o:r.setTimeout).bind(r)((()=>E("qidle"))),n.has(b))){const e=h("[on\\:"+b+"]"),t=new IntersectionObserver((e=>{for(const o of e)o.isIntersecting&&(t.unobserve(o[l]),g(o[l],"",v(b,o)))}));e[c]((e=>t.observe(e)))}},O=(e,t,o,r=!1)=>e.addEventListener(t,o,{capture:r,passive:!1}),S=(...e)=>{for(const t of e)"string"==typeof t?n.has(t)||(a.forEach((e=>O(e,t,_,!0))),O(r,t,k,!0),n.add(t)):a.has(t)||(n.forEach((e=>O(t,e,_,!0))),a.add(t))};if(!(o in e)){e[o]=0;const t=r.qwikevents;Array.isArray(t)&&S(...t),r.qwikevents={events:n,roots:a,push:S},O(e,"readystatechange",C),C()}})(document)})()</script><script>window.qwikevents.push("click", "mouseover", "focus", "qvisible", "qcinit", "qinit")</script></html>