import{d as a,z as c,c as n}from"./q-af9f9f38.js";import{P as o}from"./q-238f6065.js";const p=[{text:"Contents",id:"contents",level:1},{text:"An intriguing quote that started this",id:"an-intriguing-quote-that-started-this",level:2},{text:"The state pattern",id:"the-state-pattern",level:2},{text:"A quick primer: the loading, error, data scenario and how ideas behind the state pattern helps.",id:"a-quick-primer-the-loading-error-data-scenario-and-how-ideas-behind-the-state-pattern-helps",level:2},{text:"Where statecharts come in",id:"where-statecharts-come-in",level:2},{text:"Parallel states and nested states",id:"parallel-states-and-nested-states",level:3},{text:"Conclusion",id:"conclusion",level:2}],h={title:"Why statecharts look appealing",meta:[{name:"author",content:"Alastair Smith"},{name:"description",content:"Statecharts, beefed up state machines"},{property:"og:title",content:"Why statecharts look appealing"},{property:"og:description",content:"Statecharts, beefed up state machines"}],styles:[],links:[],frontmatter:{}},d={title:"Why statecharts look appealing",author:"Alastair Smith",description:"Statecharts, beefed up state machines",og:[{title:"Why statecharts look appealing",description:!0}]};function s(e){const t=Object.assign({h1:"h1",a:"a",span:"span",ol:"ol",li:"li",h2:"h2",p:"p",blockquote:"blockquote",pre:"pre",code:"code",em:"em",h3:"h3"},e.components);return n(o,{children:[n(t.h1,{id:"contents",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#contents",children:n(t.span,{class:"icon icon-link"})}),"Contents"]}),n(t.ol,{children:[`
`,n(t.li,{children:n(t.a,{href:"#quote",children:"An intriguing quote"})}),`
`,n(t.li,{children:n(t.a,{href:"#state-pattern",children:"State pattern"})}),`
`,n(t.li,{children:n(t.a,{href:"#illogical-state-example",children:"A quick primer"})}),`
`,n(t.li,{children:[n(t.a,{href:"#statecharts",children:"Statecharts"}),`
`,n(t.ol,{children:[`
`,n(t.li,{children:n(t.a,{href:"#parallel-nested",children:"Parallel and nested states"})}),`
`]}),`
`]}),`
`,n(t.li,{children:n(t.a,{href:"#conclusion",children:"Conclusion"})}),`
`]}),n(t.h2,{id:"an-intriguing-quote-that-started-this",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#an-intriguing-quote-that-started-this",children:n(t.span,{class:"icon icon-link"})}),"An intriguing quote that started this",n("a",{name:"quote"})]}),n(t.p,{children:["I had only really delved into this after seeing ",n(t.a,{href:"https://twitter.com/mattpocockuk",children:"Matt Pocock"})," who I think does a lot of good TypeScript content be quoted in ",n(t.a,{href:"https://2022.stateofjs.com/en-US/libraries/build-tools/",children:"https://2022.stateofjs.com/en-US/libraries/build-tools/"})," saying"]}),n(t.blockquote,{children:[`
`,n(t.p,{children:"If I were given something complicated to build from scratch, like a spreadsheet, WYSIWYG, or video calling app, I'd use XState. It's the only library I can rely on to build complex systems."}),`
`]}),n(t.p,{children:"As someone who likes to work with complicated systems while trying to make them maintainable the above piqued my interest."}),n(t.p,{children:["Disclaimer - I’ve had very little / to no hands on experience with ",n(t.a,{href:"https://stately.ai/docs/",children:"XState"})," which I’m going to reference in this article as a library to leverage statecharts in frontend applications besides reading through the documentation and seeing some of the office hour videos. On that point I’m aware of some of the trade offs of leveraging XState but appreciate some learnings only come through time in using a library. From what I have seen in passing is that the TypeScript side of XState could be improved but I believe the issues I’ve seen so far are meant to be addressed in the upcoming v5 release."]}),n(t.p,{children:["That being said there are a number of advantages that instantly stand out about ",n(t.a,{href:"https://statecharts.dev/",children:"statecharts"})," that I think are worth raising, so lets have a look."]}),n(t.h2,{id:"the-state-pattern",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#the-state-pattern",children:n(t.span,{class:"icon icon-link"})}),"The state pattern",n("a",{name:"state-pattern"})]}),n(t.p,{children:["The ",n(t.a,{href:"https://refactoring.guru/design-patterns/state",children:"state pattern"})," is one of the ",n(t.a,{href:"https://refactoring.guru/design-patterns",children:"design patterns"})," I leverage most."]}),n(t.p,{children:["As a quick side note I also quite like the ",n(t.a,{href:"https://refactoring.guru/design-patterns/strategy",children:"strategy"}),", ",n(t.a,{href:"https://refactoring.guru/design-patterns/builder",children:"builder"}),", ",n(t.a,{href:"https://refactoring.guru/design-patterns/observer",children:"observer"})," and ",n(t.a,{href:"https://refactoring.guru/design-patterns/decorator",children:"decorator"})," patterns as well but it depends on the language and problem. The pattern I dread seeing most is unsurprisingly the ",n(t.a,{href:"https://refactoring.guru/design-patterns/singleton",children:"singleton"})," pattern because used poorly presents a variety of challenges, reasoning (sanely) about state and testing becomes complicated. That being said it’s not that there aren’t use cases for it, just that lots of the time I’ve encountered a singleton it added unnecessary unburdens."]}),n(t.p,{children:"So why is the state pattern one I leverage most? Mainly because I’ve found it very useful in managing the variety of states an application can be in while removing state combinations that should not exist. Let work through a practical albeit trivial example."}),n(t.h2,{id:"a-quick-primer-the-loading-error-data-scenario-and-how-ideas-behind-the-state-pattern-helps",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#a-quick-primer-the-loading-error-data-scenario-and-how-ideas-behind-the-state-pattern-helps",children:n(t.span,{class:"icon icon-link"})}),"A quick primer: the loading, error, data scenario and how ideas behind the state pattern helps.",n("a",{name:"illogical-state-example"})]}),n(t.p,{children:"A common problem in UI is the scenario of representing to a user the different states an application goes through to show data and handle gracefully any errors. Using React as an example it’s very common to see code that looks like the following:"}),n(t.pre,{children:n(t.code,{class:"language-tsx",children:[n(t.span,{class:"token keyword",children:"import"})," ",n(t.span,{class:"token punctuation",children:"{"})," useEffect",n(t.span,{class:"token punctuation",children:","})," useState ",n(t.span,{class:"token punctuation",children:"}"})," ",n(t.span,{class:"token keyword",children:"from"})," ",n(t.span,{class:"token string",children:'"react"'}),n(t.span,{class:"token punctuation",children:";"}),`

`,n(t.span,{class:"token keyword",children:"function"})," ",n(t.span,{class:"token function",children:"Posts"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token punctuation",children:"["}),"posts",n(t.span,{class:"token punctuation",children:","})," setPosts",n(t.span,{class:"token punctuation",children:"]"})," ",n(t.span,{class:"token operator",children:"="})," ",n(t.span,{class:"token function",children:"useState"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"["}),n(t.span,{class:"token punctuation",children:"]"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token punctuation",children:"["}),"loader",n(t.span,{class:"token punctuation",children:","})," setLoader",n(t.span,{class:"token punctuation",children:"]"})," ",n(t.span,{class:"token operator",children:"="})," ",n(t.span,{class:"token function",children:"useState"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token boolean",children:"false"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token punctuation",children:"["}),"error",n(t.span,{class:"token punctuation",children:","})," setError",n(t.span,{class:"token punctuation",children:"]"})," ",n(t.span,{class:"token operator",children:"="})," ",n(t.span,{class:"token function",children:"useState"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"{"})," status",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token boolean",children:"false"}),n(t.span,{class:"token punctuation",children:","})," message",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'""'})," ",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token function-variable function",children:"fetchPosts"})," ",n(t.span,{class:"token operator",children:"="})," ",n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
    `,n(t.span,{class:"token function",children:"fetch"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token string",children:'"https://jsonplaceholder.typicode.com/posts"'}),n(t.span,{class:"token punctuation",children:")"}),`
      `,n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"then"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"response",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," response",n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"json"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:")"}),`
      `,n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"then"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"data",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
        `,n(t.span,{class:"token function",children:"setPosts"}),n(t.span,{class:"token punctuation",children:"("}),"data",n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
        `,n(t.span,{class:"token function",children:"setLoader"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token boolean",children:"false"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
      `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),`
      `,n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"catch"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"error",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
        `,n(t.span,{class:"token builtin",children:"console"}),n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"log"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token string",children:'"error"'}),n(t.span,{class:"token punctuation",children:","})," error",n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
        `,n(t.span,{class:"token function",children:"setError"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"{"})," status",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token boolean",children:"true"}),n(t.span,{class:"token punctuation",children:","})," message",n(t.span,{class:"token operator",children:":"})," error",n(t.span,{class:"token punctuation",children:"."}),"message ",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
        `,n(t.span,{class:"token function",children:"setLoader"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token boolean",children:"false"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
      `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token function",children:"useEffect"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
    `,n(t.span,{class:"token function",children:"setLoader"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token boolean",children:"true"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
    `,n(t.span,{class:"token function",children:"fetchPosts"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:","})," ",n(t.span,{class:"token punctuation",children:"["}),n(t.span,{class:"token punctuation",children:"]"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token keyword",children:"if"})," ",n(t.span,{class:"token punctuation",children:"("}),"loader",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token keyword",children:"return"})," ",n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"Loading..."}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token keyword",children:"if"})," ",n(t.span,{class:"token punctuation",children:"("}),"error",n(t.span,{class:"token punctuation",children:"."}),"status",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token keyword",children:"return"})," ",n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"Error: "}),n(t.span,{class:"token punctuation",children:"{"}),"error",n(t.span,{class:"token punctuation",children:"."}),"message",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token keyword",children:"return"})," ",n(t.span,{class:"token punctuation",children:"("}),`
    `,n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:`
      `}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h1"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"Posts"}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h1"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:`
      `}),n(t.span,{class:"token punctuation",children:"{"}),"posts",n(t.span,{class:"token punctuation",children:"."}),"length ",n(t.span,{class:"token operator",children:"==="})," ",n(t.span,{class:"token number",children:"0"})," ",n(t.span,{class:"token operator",children:"&&"})," ",n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"There are no posts"}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token plain-text",children:`
      `}),n(t.span,{class:"token punctuation",children:"{"}),"posts",n(t.span,{class:"token punctuation",children:"."}),"length ",n(t.span,{class:"token operator",children:">"})," ",n(t.span,{class:"token number",children:"0"})," ",n(t.span,{class:"token operator",children:"&&"})," ",n(t.span,{class:"token punctuation",children:"("}),`
        `,n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:`
          `}),n(t.span,{class:"token punctuation",children:"{"}),"posts",n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"map"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"post",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"("}),`
            `,n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),n(t.span,{class:"token class-name",children:"Post"})]})," ",n(t.span,{class:"token attr-name",children:"post"}),n(t.span,{class:"token script language-javascript",children:[n(t.span,{class:"token script-punctuation punctuation",children:"="}),n(t.span,{class:"token punctuation",children:"{"}),"post",n(t.span,{class:"token punctuation",children:"}"})]})," ",n(t.span,{class:"token attr-name",children:"key"}),n(t.span,{class:"token script language-javascript",children:[n(t.span,{class:"token script-punctuation punctuation",children:"="}),n(t.span,{class:"token punctuation",children:"{"}),"post",n(t.span,{class:"token punctuation",children:"."}),"id",n(t.span,{class:"token punctuation",children:"}"})]})," ",n(t.span,{class:"token punctuation",children:"/>"})]}),`
          `,n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token plain-text",children:`
        `}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),`
      `,n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token plain-text",children:`
    `}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),`
  `,n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
`,n(t.span,{class:"token punctuation",children:"}"}),`

`,n(t.span,{class:"token keyword",children:"export"})," ",n(t.span,{class:"token keyword",children:"default"})," Posts",n(t.span,{class:"token punctuation",children:";"}),`
`]})}),n(t.p,{children:["They point that I want to draw on here is that there are three different variables that are used in a conditional manner (e.g. have a truthy value / data present or falsy) to track the state of this UI. As such there are 2",n("sup",{children:"3"})," different possible number of states here that a maintainer of this code has to consider and the various combinations. Furthermore some combination of states here do not make sense to have together in this example, in the scenario that we have an error and posts what should we show the user? What happens if someone forgets to set loading to false when data is returned by the API? It becomes cumbersome to maintain and easy to make mistakes."]}),n(t.p,{children:["The core idea of the state pattern comes to the rescue here, that we are ",n(t.em,{children:"in one of the three"})," states and we should only be able to transition to a specific state that makes sense from the one we were in previously."]}),n(t.p,{children:"While in refactored example below we don't fully adhere to the state pattern (we don't encode all possible states as objects that predefine the next transition / internal behavioural difference) we do get some benefits of removing illogical combinations"}),n(t.pre,{children:n(t.code,{class:"language-tsx",children:[n(t.span,{class:"token keyword",children:"import"})," ",n(t.span,{class:"token punctuation",children:"{"})," useEffect",n(t.span,{class:"token punctuation",children:","})," useState ",n(t.span,{class:"token punctuation",children:"}"})," ",n(t.span,{class:"token keyword",children:"from"})," ",n(t.span,{class:"token string",children:'"react"'}),n(t.span,{class:"token punctuation",children:";"}),`

`,n(t.span,{class:"token keyword",children:"type"})," ",n(t.span,{class:"token class-name",children:"State"})," ",n(t.span,{class:"token operator",children:"="}),`
  `,n(t.span,{class:"token operator",children:"|"})," ",n(t.span,{class:"token punctuation",children:"{"})," state",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'"Loading"'})," ",n(t.span,{class:"token punctuation",children:"}"}),`
  `,n(t.span,{class:"token operator",children:"|"})," ",n(t.span,{class:"token punctuation",children:"{"})," state",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'"Error"'}),n(t.span,{class:"token punctuation",children:";"})," message",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'""'})," ",n(t.span,{class:"token punctuation",children:"}"}),`
  `,n(t.span,{class:"token operator",children:"|"})," ",n(t.span,{class:"token punctuation",children:"{"})," state",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'"DataRetrieved"'}),n(t.span,{class:"token punctuation",children:";"})," posts",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token punctuation",children:"["}),n(t.span,{class:"token punctuation",children:"]"})," ",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:";"}),`

`,n(t.span,{class:"token keyword",children:"function"})," ",n(t.span,{class:"token function",children:"Posts"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token punctuation",children:"["}),"currentPageState",n(t.span,{class:"token punctuation",children:","})," setPageState",n(t.span,{class:"token punctuation",children:"]"})," ",n(t.span,{class:"token operator",children:"="})," ",n(t.span,{class:"token generic-function",children:[n(t.span,{class:"token function",children:"useState"}),n(t.span,{class:"token generic class-name",children:[n(t.span,{class:"token operator",children:"<"}),"State",n(t.span,{class:"token operator",children:">"})]})]}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"{"}),`
    state`,n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'"Loading"'}),n(t.span,{class:"token punctuation",children:","}),`
  `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token function-variable function",children:"fetchPosts"})," ",n(t.span,{class:"token operator",children:"="})," ",n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
    `,n(t.span,{class:"token function",children:"fetch"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token string",children:'"https://jsonplaceholder.typicode.com/posts"'}),n(t.span,{class:"token punctuation",children:")"}),`
      `,n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"then"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"response",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," response",n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"json"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:")"}),`
      `,n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"then"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"data",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
        `,n(t.span,{class:"token function",children:"setPageState"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"{"})," state",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'"DataRetrieved"'}),n(t.span,{class:"token punctuation",children:","})," posts",n(t.span,{class:"token operator",children:":"})," data ",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
      `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),`
      `,n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"catch"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"error",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
        `,n(t.span,{class:"token builtin",children:"console"}),n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"log"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token string",children:'"error"'}),n(t.span,{class:"token punctuation",children:","})," error",n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
        `,n(t.span,{class:"token function",children:"setPageState"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"{"})," state",n(t.span,{class:"token operator",children:":"})," ",n(t.span,{class:"token string",children:'"Error"'}),n(t.span,{class:"token punctuation",children:","})," message",n(t.span,{class:"token operator",children:":"})," error",n(t.span,{class:"token punctuation",children:"."}),"message ",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
      `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token function",children:"useEffect"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"{"}),`
    `,n(t.span,{class:"token function",children:"fetchPosts"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token punctuation",children:","})," ",n(t.span,{class:"token punctuation",children:"["}),n(t.span,{class:"token punctuation",children:"]"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token keyword",children:"if"})," ",n(t.span,{class:"token punctuation",children:"("}),"currentPageState",n(t.span,{class:"token punctuation",children:"."}),"state ",n(t.span,{class:"token operator",children:"==="})," ",n(t.span,{class:"token string",children:'"Loading"'}),n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token keyword",children:"return"})," ",n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"Loading..."}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token keyword",children:"if"})," ",n(t.span,{class:"token punctuation",children:"("}),"currentPageState",n(t.span,{class:"token punctuation",children:"."}),"state ",n(t.span,{class:"token operator",children:"==="})," ",n(t.span,{class:"token string",children:'"Error"'}),n(t.span,{class:"token punctuation",children:")"}),`
    `,n(t.span,{class:"token keyword",children:"return"})," ",n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"Error: "}),n(t.span,{class:"token punctuation",children:"{"}),"currentPageState",n(t.span,{class:"token punctuation",children:"."}),"message",n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token punctuation",children:";"}),`

  `,n(t.span,{class:"token comment",children:"// we've said that there can't possibly be any other states so we're safe to destructure!"}),`
  `,n(t.span,{class:"token keyword",children:"const"})," ",n(t.span,{class:"token punctuation",children:"{"})," posts ",n(t.span,{class:"token punctuation",children:"}"})," ",n(t.span,{class:"token operator",children:"="})," currentPageState",n(t.span,{class:"token punctuation",children:";"}),`
  `,n(t.span,{class:"token keyword",children:"return"})," ",n(t.span,{class:"token punctuation",children:"("}),`
    `,n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:`
      `}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h1"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"Posts"}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h1"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:`
      `}),n(t.span,{class:"token punctuation",children:"{"}),"posts",n(t.span,{class:"token punctuation",children:"."}),"length ",n(t.span,{class:"token operator",children:"==="})," ",n(t.span,{class:"token number",children:"0"})," ",n(t.span,{class:"token operator",children:"&&"})," ",n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:"There are no posts"}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"h3"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token plain-text",children:`
      `}),n(t.span,{class:"token punctuation",children:"{"}),"posts",n(t.span,{class:"token punctuation",children:"."}),"length ",n(t.span,{class:"token operator",children:">"})," ",n(t.span,{class:"token number",children:"0"})," ",n(t.span,{class:"token operator",children:"&&"})," ",n(t.span,{class:"token punctuation",children:"("}),`
        `,n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),n(t.span,{class:"token plain-text",children:`
          `}),n(t.span,{class:"token punctuation",children:"{"}),"posts",n(t.span,{class:"token punctuation",children:"."}),n(t.span,{class:"token function",children:"map"}),n(t.span,{class:"token punctuation",children:"("}),n(t.span,{class:"token punctuation",children:"("}),"post",n(t.span,{class:"token punctuation",children:")"})," ",n(t.span,{class:"token operator",children:"=>"})," ",n(t.span,{class:"token punctuation",children:"("}),`
            `,n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"<"}),n(t.span,{class:"token class-name",children:"Post"})]})," ",n(t.span,{class:"token attr-name",children:"post"}),n(t.span,{class:"token script language-javascript",children:[n(t.span,{class:"token script-punctuation punctuation",children:"="}),n(t.span,{class:"token punctuation",children:"{"}),"post",n(t.span,{class:"token punctuation",children:"}"})]})," ",n(t.span,{class:"token attr-name",children:"key"}),n(t.span,{class:"token script language-javascript",children:[n(t.span,{class:"token script-punctuation punctuation",children:"="}),n(t.span,{class:"token punctuation",children:"{"}),"post",n(t.span,{class:"token punctuation",children:"."}),"id",n(t.span,{class:"token punctuation",children:"}"})]})," ",n(t.span,{class:"token punctuation",children:"/>"})]}),`
          `,n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token plain-text",children:`
        `}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),`
      `,n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:"}"}),n(t.span,{class:"token plain-text",children:`
    `}),n(t.span,{class:"token tag",children:[n(t.span,{class:"token tag",children:[n(t.span,{class:"token punctuation",children:"</"}),"div"]}),n(t.span,{class:"token punctuation",children:">"})]}),`
  `,n(t.span,{class:"token punctuation",children:")"}),n(t.span,{class:"token punctuation",children:";"}),`
`,n(t.span,{class:"token punctuation",children:"}"}),`

`,n(t.span,{class:"token keyword",children:"export"})," ",n(t.span,{class:"token keyword",children:"default"})," Posts",n(t.span,{class:"token punctuation",children:";"}),`
`]})}),n(t.p,{children:["The state pattern is closely related to the idea of ",n(t.a,{href:"https://en.wikipedia.org/wiki/Finite-state_machine",children:"finite-state machines"}),". In more complicated scenarios than the one above ",n(t.a,{href:"https://statecharts.dev/state-machine-state-explosion.html",children:"“state explosion”"})," can happen, e.g. what happens if we can be in any one of the above states AND have to combine with the user's authenticated status? In that scenario we have 6 different possible states from the previous 3 because we have to be able to combine each with our new state. Furthermore we have to be able to account for transitions to each possible combination. Imagine if we were to add another variable on top and then once again! The type of examples Matt gave often have lots of possible states that can be combined. The state pattern can help manage this more elegantly but we still have a lot of overhead from state explosion."]}),n(t.h2,{id:"where-statecharts-come-in",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#where-statecharts-come-in",children:n(t.span,{class:"icon icon-link"})}),"Where statecharts come in"]}),n(t.p,{children:["As according to ",n(t.a,{href:"https://statecharts.dev/what-is-a-statechart.html",children:"https://statecharts.dev/what-is-a-statechart.html"}),", a statechart can be defined as"]}),n(t.blockquote,{children:[`
`,n(t.p,{children:["The primary feature of statecharts is that states can be organized in a ",n(t.em,{children:"hierarchy"}),": A statechart is a ",n(t.a,{href:"https://statecharts.dev/what-is-a-state-machine.html",children:"state machine"})," where each state in the state machine may define its own ",n(t.em,{children:"subordinate"})," state machines, called ",n(t.em,{children:"substates"}),". Those states can again define substates."]}),`
`]}),n(t.p,{children:["Their origins are from David Harel in a 1987 ",n(t.a,{href:"https://www.sciencedirect.com/science/article/pii/0167642387900359?ref=pdf_download&fr=RR-2&rr=7ad9d87c9f82889e",children:"paper"})," called “A visual formalization for complex systems”."]}),n(t.p,{children:["Statecharts have a number of benefits including (sourced ",n(t.a,{href:"https://xstate.js.org/docs/about/concepts.html#statecharts",children:"https://xstate.js.org/docs/about/concepts.html#statecharts"}),"):"]}),n(t.ol,{children:[`
`,n(t.li,{children:"Have parallel states"}),`
`,n(t.li,{children:"Have nested states (aka “child states”)"}),`
`,n(t.li,{children:"Transitions can be guarded"}),`
`,n(t.li,{children:"Delays"}),`
`,n(t.li,{children:"Behaviour is decoupled from the component"}),`
`,n(t.li,{children:"Actions on state entry"}),`
`]}),n(t.p,{children:"I particularly want to talk about the merits of points 1 and 2 in this post but that’s not to say the others are less valuable."}),n(t.h3,{id:"parallel-states-and-nested-states",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#parallel-states-and-nested-states",children:n(t.span,{class:"icon icon-link"})}),"Parallel states and nested states"]}),n(t.p,{children:["The docs for both of these from xstate give great examples. Starting with ",n(t.a,{href:"https://stately.ai/docs/states/parallel-states",children:"parallel"})," a classic example is that for a video player we can have both video and audio in different states. Parallel states allow us to encapsulate variables that do not overlap with one another, preventing state explosion because we don't have less transitions to model. In the docs examples we have two different substates for each but we want for our state machine to be able to handle these separately. With the ",n(t.a,{href:"https://stately.ai/docs/states/parent-states",children:"child"})," state again we see a more complicated example where there can be substates within a parent state. This is a very common pattern, e.g. a modal that overlays a screen with text editor. The benefit here is that we strictly state the environment to which some states make sense and in essence create a dependency, again preventing state explosion."]}),n(t.h2,{id:"conclusion",children:[n(t.a,{"aria-hidden":"true",tabindex:"-1",href:"#conclusion",children:n(t.span,{class:"icon icon-link"})}),"Conclusion"]}),n(t.p,{children:"Statecharts as a way of organising application state / orchestrating the flow to which a user can encounter in my mind bring a lot of benefits:"}),n(t.ol,{children:[`
`,n(t.li,{children:"First and foremost it is a signficant improvement upon state machines, preventing state explosions."}),`
`,n(t.li,{children:"It enforces the upfront thinking of variety of possible states, meaning error states / edge cases are less likely to be forgotten."}),`
`,n(t.li,{children:["Being able to visually organise and share statecharts is a great asset. In theory being able to share statecharts (",n(t.a,{href:"https://stately.ai/",children:"Stately.ai"}),", the company behind XState have smartly invested heavily into their visual editor) can bridge a lot of gaps across disciplines to have a unified understanding of the desired behaviour."]}),`
`,n(t.li,{children:"Having the logic of statecharts decoupled from your UI framework is also nice."}),`
`,n(t.li,{children:"Other features that I haven’t delved into such as guarded transitions and actions on entry are also very beneficial."}),`
`]}),n(t.p,{children:["In my mind statecharts seem like a great tool to managing complexity and I can understand the claim that is originally quoted at the top of this article a lot more than when I started. One benefit on the list above that is important to me is understanding and modelling edge / error cases and accounting for them gracefully. Error handling is often sub optimally handled in languages / applications and is one of the reasons I really like ",n(t.a,{href:"https://users.rust-lang.org/",children:"Rust's"})," ",n(t.a,{href:"https://doc.rust-lang.org/book/ch09-00-error-handling.html",children:"approach"}),". What does surprise me is the lack of maturity in terms of tooling / libraries outside of XState around statecharts from what I've seen."]})]})}function i(e={}){const{wrapper:t}=e.components||{};return t?n(t,Object.assign({},e,{children:n(s,e)})):s(e)}const u=()=>a(c,{children:a(i,{},3,null)},3,"KYgFW64j");export{u as default,d as frontmatter,h as head,p as headings};
